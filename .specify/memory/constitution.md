<!--
===================== 同期影響レポート =====================
バージョン変更: 0.0.0 → 1.0.0
変更の種類: MAJOR（初回制定）

追加セクション:
- 5つの核心原則（I〜V）
- 技術スタック要件
- 開発ワークフロー
- ガバナンスルール

テンプレート更新状況:
- ✅ plan-template.md: Constitution Check セクションと整合
- ✅ spec-template.md: ユーザーストーリー・要件形式と整合
- ✅ tasks-template.md: フェーズ構造・並列タスク形式と整合

保留事項: なし
============================================================
-->

# Estimate Poker Next コンスティチューション

## 核心原則

### I. ユーザー体験優先

全ての機能は、ユーザーが直感的に使える体験を最優先として設計しなければならない（MUST）。
プランニングポーカーの本質は「バイアスを減らし、チームで正確な見積もりを行う」ことにある。

- 見積もり画面はカードゲーム風UIで視覚的に分かりやすくする
- リアルタイム更新により参加者全員が最新状態を把握できる
- ゲストユーザーでも認証なしで即座に参加可能とする
- エラー時は明確なフィードバックを表示する

**理由**: 複雑な設定や操作は見積もりセッションの効率を下げ、本来の目的を阻害する。

### II. 認証とゲストの共存

認証ユーザーとゲストユーザーの両方をサポートし、それぞれの権限を明確に分離しなければならない（MUST）。

- ゲストユーザー: ニックネームのみで一時セッション作成・参加が可能
- 認証ユーザー: プロジェクト・タスク管理、履歴参照が可能
- 権限チェックはAPIルートで必ず実行する
- セッションオーナーのみが公開/非公開切り替え、工数確定を実行可能

**理由**: 素早く始められるゲスト体験と、継続的な管理が必要な認証体験の両立がサービスの価値を高める。

### III. 型安全性とスキーマ駆動開発

TypeScriptの厳格モードとPrismaスキーマを起点とした開発を徹底しなければならない（MUST）。

- `strict: true` を維持し、`any` 型の使用は禁止
- データベース変更は必ずPrismaマイグレーションを通じて行う
- APIレスポンス型は明示的に定義する
- コンポーネントPropsは型定義を必須とする

**理由**: 型安全性はランタイムエラーを防ぎ、リファクタリングの信頼性を高める。

### IV. シンプルさの維持

機能追加は最小限に留め、過度な抽象化やオーバーエンジニアリングを避けなければならない（MUST）。

- 要求された機能のみを実装する（YAGNIの原則）
- 3回以上繰り返されるまでユーティリティ関数化しない
- 仮定の将来要件のためのコードは書かない
- 設定やオプションは必要になるまで追加しない

**理由**: 複雑さはバグの温床となり、メンテナンスコストを増大させる。

### V. 段階的リリース

機能はフェーズごとに段階的にリリースし、各フェーズで独立して動作確認できなければならない（MUST）。

- MVP（最小viable product）を最優先でリリース
- 各ユーザーストーリーは独立してテスト可能な単位とする
- 破壊的変更はメジャーバージョンアップで行う
- ロールバック可能な状態を維持する

**理由**: 早期フィードバックを得ることで、方向修正のコストを最小化する。

## 技術スタック要件

本プロジェクトは以下の技術スタックを使用する。変更する場合はコンスティチューションの改訂が必要。

| カテゴリ | 技術 | バージョン |
|---------|------|-----------|
| フレームワーク | Next.js (App Router) | 16.x |
| ランタイム | React | 19.x |
| 言語 | TypeScript | 5.x (strict mode) |
| ORM | Prisma | 6.x |
| データベース | PostgreSQL | - |
| 認証 | NextAuth.js | v4.x |
| スタイリング | Tailwind CSS | v4 |

**依存関係追加の基準**:
- 既存パッケージで解決できない問題があること
- メンテナンスが活発であること（最終更新6ヶ月以内推奨）
- 型定義が提供されていること

## 開発ワークフロー

### コード品質ゲート

1. **Lintチェック**: `npm run lint` がエラーなく通過すること
2. **型チェック**: `npm run type-check` がエラーなく通過すること
3. **ビルド確認**: `npm run build` が成功すること
4. **Prisma同期**: スキーマ変更後は `npx prisma generate` を実行すること

### コミット規約

セマンティックコミットメッセージを使用する:
- `feat:` 新機能追加
- `fix:` バグ修正
- `refactor:` リファクタリング（機能変更なし）
- `docs:` ドキュメント変更
- `chore:` ビルド・設定変更

### ブランチ戦略

- `main`: 本番ブランチ
- `develop`: 開発ブランチ（ステージング）
- `claude/*`: AI アシスタント作業ブランチ

## ガバナンス

### コンスティチューション遵守

- 全てのPR・レビューは本コンスティチューションへの準拠を確認しなければならない
- 原則違反が必要な場合は、理由を明示して例外として文書化する
- 複雑さの追加は「Complexity Tracking」テーブルで正当化する

### 改訂手続き

1. 改訂提案をPRとして作成
2. 変更内容と理由を明記
3. バージョン番号を更新（MAJOR.MINOR.PATCH）
4. 影響を受けるテンプレートを同時に更新

### バージョニング

- **MAJOR**: 原則の削除・再定義など後方互換性のない変更
- **MINOR**: 新しい原則・セクションの追加
- **PATCH**: 文言の明確化、誤字修正

**Version**: 1.0.0 | **Ratified**: 2025-12-28 | **Last Amended**: 2025-12-28
